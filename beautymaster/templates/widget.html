<div style="padding: 20px; font-family: 'Segoe UI', Arial, sans-serif;">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --primary-light: #eef2ff;
            --secondary: #06d6a0;
            --danger: #ef476f;
            --warning: #ffd166;
            --dark: #2b2d42;
            --gray: #6c757d;
            --light: #636363;
            --border: #dee2e6;
            --card-bg: #686868;
            --text: #212529;
            --text-muted: #6c757d;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 10px 15px rgba(0, 0, 0, 0.2);
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #4895ef;
                --primary-dark: #3f7ed9;
                --primary-light: #1e2f4a;
                --secondary: #06d6a0;
                --danger: #f25f5c;
                --warning: #ffd166;
                --dark: #121420;
                --gray: #9ca3af;
                --light: #1e1e2e;
                --border: #2d3748;
                --card-bg: #2a2a3a;
                --text: #e5e7eb;
                --text-muted: #9ca3af;
                --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
                --shadow-hover: 0 10px 15px rgba(0, 0, 0, 0.4);
            }
        }

        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .bm-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* –¢–∞–±—ã */
        .bm-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            padding: 4px;
            background: var(--light);
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        .bm-tab {
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            font-weight: 600;
            color: var(--text-muted);
            background: transparent;
            flex: 1;
            text-align: center;
            border: none;
        }
        .bm-tab:hover {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        .bm-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }
        .bm-tab i {
            margin-right: 8px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .bm-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }
        .bm-card:hover {
            box-shadow: var(--shadow-hover);
        }
        .bm-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }
        .bm-card-header h3 {
            margin: 0;
            color: var(--text);
            font-size: 1.4rem;
            font-weight: 600;
        }
        .bm-card-header h3 i {
            margin-right: 10px;
            color: var(--primary);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .bm-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        .bm-stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
            border: none;
        }
        .bm-stat-card:hover {
            transform: translateY(-4px);
        }
        .bm-stat-value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .bm-stat-label {
            font-size: 14px;
            opacity: 0.95;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .bm-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }
        .bm-btn-primary {
            background: var(--primary);
            color: white;
        }
        .bm-btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        .bm-btn-secondary {
            background: var(--secondary);
            color: white;
        }
        .bm-btn-secondary:hover {
            filter: brightness(0.9);
            transform: translateY(-2px);
        }
        .bm-btn-danger {
            background: var(--danger);
            color: white;
        }
        .bm-btn-danger:hover {
            filter: brightness(0.9);
            transform: translateY(-2px);
        }
        .bm-btn-outline {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text);
        }
        .bm-btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* –¢–∞–±–ª–∏—Ü—ã */
        .bm-table {
            width: 100%;
            border-collapse: collapse;
        }
        .bm-table th {
            background: var(--light);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text);
            border-bottom: 2px solid var(--primary);
        }
        .bm-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }
        .bm-table tr:hover {
            background: var(--light);
        }
        .bm-table .badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        .bm-table .badge-success {
            background: var(--secondary);
            color: white;
        }
        .bm-table .badge-warning {
            background: var(--warning);
            color: var(--dark);
        }
        .bm-table .badge-danger {
            background: var(--danger);
            color: white;
        }

        /* –§–æ—Ä–º—ã */
        .bm-form-group {
            margin-bottom: 20px;
        }
        .bm-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }
        .bm-form-group input, 
        .bm-form-group select, 
        .bm-form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 14px;
            transition: all 0.2s;
        }
        .bm-form-group input:focus, 
        .bm-form-group select:focus, 
        .bm-form-group textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        .bm-form-group small {
            display: block;
            margin-top: 4px;
            color: var(--text-muted);
            font-size: 12px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .bm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 1000;
            animation: fadeIn 0.3s;
        }
        .bm-modal-content {
            background: var(--card-bg);
            width: 90%;
            max-width: 550px;
            margin: 50px auto;
            padding: 30px;
            border-radius: 24px;
            box-shadow: var(--shadow-hover);
            border: 1px solid var(--border);
            animation: slideUp 0.3s;
        }
        .bm-modal-content h3 {
            margin-top: 0;
            margin-bottom: 24px;
            color: var(--primary);
            font-size: 1.6rem;
        }

        /* –°—Ç–∞—Ç—É—Å—ã */
        .bm-status {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-weight: 500;
        }
        .bm-status-success {
            background: var(--secondary);
            color: white;
        }
        .bm-status-warning {
            background: var(--warning);
            color: var(--dark);
        }
        .bm-status-danger {
            background: var(--danger);
            color: white;
        }
        .bm-status-info {
            background: var(--primary);
            color: white;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .bm-loading {
            text-align: center;
            padding: 60px;
            color: var(--text-muted);
        }
        .bm-loading-spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .bm-empty {
            text-align: center;
            padding: 60px;
            color: var(--text-muted);
        }
        .bm-empty i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */
        .bm-instruction {
            margin-top: 24px;
            padding: 20px;
            background: var(--primary-light);
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }
        .bm-instruction h4 {
            margin-top: 0;
            color: var(--primary);
            font-weight: 600;
        }
        .bm-instruction ol {
            margin: 0;
            padding-left: 20px;
            color: var(--text);
        }
        .bm-instruction li {
            margin: 8px 0;
        }

        /* –ß–µ–∫–±–æ–∫—Å */
        .bm-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        .bm-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        /* –ë–∞–¥–∂ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ */
        .priority-high {
            background: var(--danger);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }
        .priority-medium {
            background: var(--warning);
            color: var(--dark);
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }
        .priority-low {
            background: var(--secondary);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }
    </style>

    <div class="bm-container">
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="bm-auth-required" style="display: none;">
            <div class="bm-card" style="text-align: center; padding: 60px;">
                <i style="font-size: 64px; color: var(--danger); margin-bottom: 20px;">üîí</i>
                <h2 style="color: var(--text);">–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                <p style="color: var(--text-muted); margin: 20px 0;">–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞–≥–∏–Ω–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</p>
                <button class="bm-btn bm-btn-primary" onclick="window.location.href='/login'" style="padding: 12px 40px;">–í–æ–π—Ç–∏</button>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div id="bm-content-wrapper" style="display: none;">
            <!-- –¢–∞–±—ã -->
            <div class="bm-tabs">
                <button class="bm-tab active" onclick="switchTab('dashboard')">
                    <i>üìä</i> –î–∞—à–±–æ—Ä–¥
                </button>
                <button class="bm-tab" onclick="switchTab('services')">
                    <i>üìã</i> –£—Å–ª—É–≥–∏
                </button>
                <button class="bm-tab" onclick="switchTab('clients')">
                    <i>üë•</i> –ö–ª–∏–µ–Ω—Ç—ã
                </button>
                <button class="bm-tab" onclick="switchTab('bookings')">
                    <i>üìÖ</i> –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                </button>
                <button class="bm-tab" onclick="switchTab('schedule')">
                    <i>‚öôÔ∏è</i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>

            <!-- –î–∞—à–±–æ—Ä–¥ -->
            <div id="tab-dashboard" class="bm-content active">
                <div id="dashboard-loading">
                    <div class="bm-loading">
                        <div class="bm-loading-spinner"></div>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
                    </div>
                </div>
                <div id="dashboard-content" style="display: none;"></div>
            </div>

            <!-- –£—Å–ª—É–≥–∏ -->
            <div id="tab-services" class="bm-content">
                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>üìã</i> –£—Å–ª—É–≥–∏</h3>
                        <button class="bm-btn bm-btn-primary" onclick="showServiceModal()">
                            <i>‚ûï</i> –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
                        </button>
                    </div>
                    <div id="services-list" class="bm-loading">–ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥...</div>
                </div>
            </div>

            <!-- –ö–ª–∏–µ–Ω—Ç—ã -->
            <div id="tab-clients" class="bm-content">
                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>üë•</i> –ö–ª–∏–µ–Ω—Ç—ã</h3>
                        <button class="bm-btn bm-btn-primary" onclick="showClientModal()">
                            <i>‚ûï</i> –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
                        </button>
                    </div>
                    <div id="clients-list" class="bm-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤...</div>
                </div>
            </div>

            <!-- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div id="tab-bookings" class="bm-content">
                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>üìÖ</i> –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                        <button class="bm-btn bm-btn-primary" onclick="showBookingModal()">
                            <i>‚ûï</i> –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                        </button>
                    </div>
                    <div id="bookings-list" class="bm-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π...</div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div id="tab-schedule" class="bm-content">
                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>‚öôÔ∏è</i> –ü—Ä–æ—Ñ–∏–ª—å</h3>
                    </div>
                    <div id="profile-form"></div>
                </div>

                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>üìÖ</i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã</h3>
                    </div>
                    <div id="schedule-form"></div>
                </div>
                
                <!-- –ë–ª–æ–∫ Telegram –±–æ—Ç–∞ -->
                <div class="bm-card">
                    <div class="bm-card-header">
                        <h3><i>ü§ñ</i> Telegram –±–æ—Ç</h3>
                    </div>
                    
                    <div id="bot-status" style="margin-bottom: 20px;"></div>
                    
                    <div class="bm-form-group">
                        <label>–¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–æ—Ç @BotFather)</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="password" id="botToken" placeholder="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz" value="" style="flex: 1;">
                            <button class="bm-btn bm-btn-outline" onclick="toggleTokenVisibility()" style="width: 50px;">üëÅÔ∏è</button>
                        </div>
                        <small>–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram</small>
                    </div>
                    
                    <div class="bm-form-group">
                        <label>ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–≤–∞—à Telegram ID)</label>
                        <input type="text" id="adminId" placeholder="123456789" value="">
                        <small>–£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π ID —É @userinfobot</small>
                    </div>
                    
                    <div class="bm-form-group">
                        <label class="bm-checkbox">
                            <input type="checkbox" id="botEnabled">
                            <span>–í–∫–ª—é—á–∏—Ç—å –±–æ—Ç–∞</span>
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button class="bm-btn bm-btn-primary" onclick="saveBotSettings()" style="flex: 1;">
                            <i>üíæ</i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>
                        <button class="bm-btn bm-btn-secondary" onclick="testBot()" style="flex: 1;">
                            <i>üì±</i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                        </button>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="bm-btn bm-btn-outline" onclick="restartBot()" style="flex: 1;">
                            <i>üîÑ</i> –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
                        </button>
                        <button class="bm-btn bm-btn-outline" onclick="clearToken()" style="flex: 1;">
                            <i>üóëÔ∏è</i> –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω
                        </button>
                    </div>
                    
                    <div id="bot-stats" style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: 12px;">
                        <h4 style="margin-top: 0; color: var(--text);"><i>üìä</i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞</h4>
                        <div id="bot-stats-content">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                    
                    <div class="bm-instruction">
                        <h4><i>üìö</i> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h4>
                        <ol>
                            <li><strong>–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫:</strong> –í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ ID, –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"</li>
                            <li><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong> –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å" - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ</li>
                            <li><strong>–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω:</strong> –ù–∞–∂–º–∏—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω", –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π</li>
                            <li><strong>–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:</strong> –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–∞–∂–º–∏—Ç–µ "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å"</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É—Å–ª—É–≥ -->
    <div id="serviceModal" class="bm-modal">
        <div class="bm-modal-content">
            <h3 id="serviceModalTitle">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</h3>
            <div class="bm-form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input type="text" id="serviceName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°—Ç—Ä–∏–∂–∫–∞">
            </div>
            <div class="bm-form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="serviceDescription" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"></textarea>
            </div>
            <div class="bm-form-group">
                <label>–¶–µ–Ω–∞ (‚ÇΩ)</label>
                <input type="number" id="servicePrice" placeholder="1000">
            </div>
            <div class="bm-form-group">
                <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω)</label>
                <input type="number" id="serviceDuration" value="60">
            </div>
            <div class="bm-form-group">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select id="serviceCategory">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                    <option value="hair">üíá –°—Ç—Ä–∏–∂–∫–∞</option>
                    <option value="color">üé® –û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ</option>
                    <option value="makeup">üíÑ –ú–∞–∫–∏—è–∂</option>
                    <option value="nails">üíÖ –ú–∞–Ω–∏–∫—é—Ä</option>
                    <option value="other">‚ú® –î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="bm-btn bm-btn-outline" onclick="hideModal('serviceModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="bm-btn bm-btn-primary" onclick="saveService()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ -->
    <div id="clientModal" class="bm-modal">
        <div class="bm-modal-content">
            <h3 id="clientModalTitle">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</h3>
            <div class="bm-form-group">
                <label>–ò–º—è</label>
                <input type="text" id="clientName" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
            </div>
            <div class="bm-form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                <input type="text" id="clientPhone" placeholder="+7 (999) 999-99-99">
            </div>
            <div class="bm-form-group">
                <label>Email</label>
                <input type="email" id="clientEmail" placeholder="client@example.com">
            </div>
            <div class="bm-form-group">
                <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                <input type="date" id="clientBirthDate">
            </div>
            <div class="bm-form-group">
                <label>–ó–∞–º–µ—Ç–∫–∏</label>
                <textarea id="clientNotes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"></textarea>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="bm-btn bm-btn-outline" onclick="hideModal('clientModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="bm-btn bm-btn-primary" onclick="saveClient()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π -->
    <div id="bookingModal" class="bm-modal">
        <div class="bm-modal-content">
            <h3>üìÖ –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
            <div class="bm-form-group">
                <label>–ö–ª–∏–µ–Ω—Ç</label>
                <select id="bookingClient"></select>
            </div>
            <div class="bm-form-group">
                <label>–£—Å–ª—É–≥–∞</label>
                <select id="bookingService"></select>
            </div>
            <div class="bm-form-group">
                <label>–î–∞—Ç–∞</label>
                <input type="date" id="bookingDate">
            </div>
            <div class="bm-form-group">
                <label>–í—Ä–µ–º—è</label>
                <select id="bookingTime"></select>
            </div>
            <div class="bm-form-group">
                <label>–ó–∞–º–µ—Ç–∫–∏</label>
                <textarea id="bookingNotes" rows="3"></textarea>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="bm-btn bm-btn-outline" onclick="hideModal('bookingModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="bm-btn bm-btn-primary" onclick="saveBooking()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>


    <script>
        // ==================== –ü–†–û–í–ï–†–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ====================
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/me');
                if (response.status === 401) {
                    document.getElementById('bm-auth-required').style.display = 'block';
                    document.getElementById('bm-content-wrapper').style.display = 'none';
                } else {
                    document.getElementById('bm-auth-required').style.display = 'none';
                    document.getElementById('bm-content-wrapper').style.display = 'block';
                    loadDashboard();
                }
            } catch (error) {
                console.error('Auth check error:', error);
                document.getElementById('bm-auth-required').style.display = 'block';
                document.getElementById('bm-content-wrapper').style.display = 'none';
            }
        }

        // ==================== –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let currentServiceId = null;
        let currentClientId = null;
        let services = [];
        let clients = [];
        let bookings = [];
        let tokenVisible = false;

        // ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö ====================
        window.switchTab = function(tabName) {
            document.querySelectorAll('.bm-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.bm-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            switch(tabName) {
                case 'dashboard': loadDashboard(); break;
                case 'services': loadServices(); break;
                case 'clients': loadClients(); break;
                case 'bookings': loadBookings(); break;
                case 'schedule': loadProfile(); loadSchedule(); break;
            }
        }

        // ==================== –î–ê–®–ë–û–†–î ====================
        async function loadDashboard() {
            document.getElementById('dashboard-loading').style.display = 'block';
            document.getElementById('dashboard-content').style.display = 'none';
            
            try {
                const response = await fetch('/api/plugins/beautymaster/stats');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    document.getElementById('dashboard-content').innerHTML = `
                        <div class="bm-stats-grid">
                            <div class="bm-stat-card">
                                <div class="bm-stat-value">${stats.total_clients}</div>
                                <div class="bm-stat-label">–ö–ª–∏–µ–Ω—Ç–æ–≤</div>
                            </div>
                            <div class="bm-stat-card">
                                <div class="bm-stat-value">${stats.total_services}</div>
                                <div class="bm-stat-label">–£—Å–ª—É–≥</div>
                            </div>
                            <div class="bm-stat-card">
                                <div class="bm-stat-value">${stats.total_bookings}</div>
                                <div class="bm-stat-label">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
                            </div>
                            <div class="bm-stat-card">
                                <div class="bm-stat-value">${stats.month_bookings}</div>
                                <div class="bm-stat-label">–ó–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</div>
                            </div>
                        </div>
                        <div class="bm-card">
                            <h4>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏</h4>
                            <table class="bm-table">
                                <thead>
                                    <tr><th>–£—Å–ª—É–≥–∞</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th></tr>
                                </thead>
                                <tbody>
                                    ${stats.popular_services.map(s => `
                                        <tr><td>${s.name}</td><td>${s.count}</td></tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                    document.getElementById('dashboard-loading').style.display = 'none';
                    document.getElementById('dashboard-content').style.display = 'block';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('dashboard-loading').innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }

        // ==================== –£–°–õ–£–ì–ò ====================
        async function loadServices() {
            const container = document.getElementById('services-list');
            container.innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥...';
            
            try {
                const response = await fetch('/api/plugins/beautymaster/services');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    services = data.data;
                    if (services.length === 0) {
                        container.innerHTML = '<p style="color: #666; text-align: center;">–ù–µ—Ç —É—Å–ª—É–≥. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</p>';
                    } else {
                        container.innerHTML = `
                            <table class="bm-table">
                                <thead>
                                    <tr>
                                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–¶–µ–Ω–∞</th>
                                        <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${services.map(s => `
                                        <tr>
                                            <td>${s.name}</td>
                                            <td>${s.category || '‚Äî'}</td>
                                            <td>${s.price} ‚ÇΩ</td>
                                            <td>${s.duration} –º–∏–Ω</td>
                                            <td>
                                                <button class="bm-btn bm-btn-primary" style="padding: 5px 10px;" onclick="editService(${s.id})">‚úèÔ∏è</button>
                                                <button class="bm-btn bm-btn-danger" style="padding: 5px 10px;" onclick="deleteService(${s.id})">üóëÔ∏è</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                container.innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }

        window.showServiceModal = function(id = null) {
            currentServiceId = id;
            document.getElementById('serviceModalTitle').innerText = id ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥—É' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É';
            
            if (id) {
                const service = services.find(s => s.id === id);
                if (service) {
                    document.getElementById('serviceName').value = service.name;
                    document.getElementById('serviceDescription').value = service.description || '';
                    document.getElementById('servicePrice').value = service.price;
                    document.getElementById('serviceDuration').value = service.duration;
                    document.getElementById('serviceCategory').value = service.category || '';
                }
            } else {
                document.getElementById('serviceName').value = '';
                document.getElementById('serviceDescription').value = '';
                document.getElementById('servicePrice').value = '';
                document.getElementById('serviceDuration').value = '60';
                document.getElementById('serviceCategory').value = '';
            }
            
            document.getElementById('serviceModal').style.display = 'block';
        }

        window.saveService = async function() {
            const data = {
                name: document.getElementById('serviceName').value,
                description: document.getElementById('serviceDescription').value,
                price: parseFloat(document.getElementById('servicePrice').value),
                duration: parseInt(document.getElementById('serviceDuration').value),
                category: document.getElementById('serviceCategory').value
            };
            
            try {
                const url = currentServiceId 
                    ? `/api/plugins/beautymaster/services/${currentServiceId}`
                    : '/api/plugins/beautymaster/services';
                
                const response = await fetch(url, {
                    method: currentServiceId ? 'PUT' : 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    hideModal('serviceModal');
                    loadServices();
                } else {
                    alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        window.deleteService = async function(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É?')) return;
            
            try {
                const response = await fetch(`/api/plugins/beautymaster/services/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadServices();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
            }
        }

        window.editService = function(id) {
            showServiceModal(id);
        }

        // ==================== –ö–õ–ò–ï–ù–¢–´ ====================
        async function loadClients() {
            const container = document.getElementById('clients-list');
            container.innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤...';
            
            try {
                const response = await fetch('/api/plugins/beautymaster/clients');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    clients = data.data;
                    if (clients.length === 0) {
                        container.innerHTML = '<p style="color: #666; text-align: center;">–ù–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ!</p>';
                    } else {
                        container.innerHTML = `
                            <table class="bm-table">
                                <thead>
                                    <tr>
                                        <th>–ò–º—è</th>
                                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                        <th>Email</th>
                                        <th>–í–∏–∑–∏—Ç–æ–≤</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${clients.map(c => `
                                        <tr>
                                            <td>${c.name}</td>
                                            <td>${c.phone}</td>
                                            <td>${c.email || '‚Äî'}</td>
                                            <td>${c.total_visits || 0}</td>
                                            <td>
                                                <button class="bm-btn bm-btn-primary" style="padding: 5px 10px;" onclick="editClient(${c.id})">‚úèÔ∏è</button>
                                                <button class="bm-btn bm-btn-danger" style="padding: 5px 10px;" onclick="deleteClient(${c.id})">üóëÔ∏è</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                container.innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }

        window.showClientModal = function(id = null) {
            currentClientId = id;
            document.getElementById('clientModalTitle').innerText = id ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞';
            
            if (id) {
                const client = clients.find(c => c.id === id);
                if (client) {
                    document.getElementById('clientName').value = client.name;
                    document.getElementById('clientPhone').value = client.phone;
                    document.getElementById('clientEmail').value = client.email || '';
                    document.getElementById('clientBirthDate').value = client.birth_date || '';
                    document.getElementById('clientNotes').value = client.notes || '';
                }
            } else {
                document.getElementById('clientName').value = '';
                document.getElementById('clientPhone').value = '';
                document.getElementById('clientEmail').value = '';
                document.getElementById('clientBirthDate').value = '';
                document.getElementById('clientNotes').value = '';
            }
            
            document.getElementById('clientModal').style.display = 'block';
        }

        window.saveClient = async function() {
            const data = {
                name: document.getElementById('clientName').value,
                phone: document.getElementById('clientPhone').value,
                email: document.getElementById('clientEmail').value,
                birth_date: document.getElementById('clientBirthDate').value,
                notes: document.getElementById('clientNotes').value
            };
            
            try {
                const url = currentClientId 
                    ? `/api/plugins/beautymaster/clients/${currentClientId}`
                    : '/api/plugins/beautymaster/clients';
                
                const response = await fetch(url, {
                    method: currentClientId ? 'PUT' : 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    hideModal('clientModal');
                    loadClients();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        window.deleteClient = async function(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞?')) return;
            
            try {
                const response = await fetch(`/api/plugins/beautymaster/clients/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadClients();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
            }
        }

        window.editClient = function(id) {
            showClientModal(id);
        }

        // ==================== –ë–†–û–ù–ò–†–û–í–ê–ù–ò–Ø ====================
        async function loadBookings() {
            const container = document.getElementById('bookings-list');
            container.innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π...';
            
            try {
                const response = await fetch('/api/plugins/beautymaster/bookings');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    bookings = data.data;
                    if (bookings.length === 0) {
                        container.innerHTML = '<p style="color: #666; text-align: center;">–ù–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</p>';
                    } else {
                        container.innerHTML = `
                            <table class="bm-table">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–í—Ä–µ–º—è</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–£—Å–ª—É–≥–∞</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${bookings.map(b => `
                                        <tr>
                                            <td>${b.date}</td>
                                            <td>${b.time}</td>
                                            <td>${b.client_name}</td>
                                            <td>${b.service_name}</td>
                                            <td>${b.status}</td>
                                            <td>
                                                <button class="bm-btn bm-btn-danger" style="padding: 5px 10px;" onclick="deleteBooking(${b.id})">üóëÔ∏è</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                container.innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }

        window.showBookingModal = async function() {
            try {
                const [clientsRes, servicesRes] = await Promise.all([
                    fetch('/api/plugins/beautymaster/clients'),
                    fetch('/api/plugins/beautymaster/services')
                ]);
                
                if (clientsRes.status === 401 || servicesRes.status === 401) {
                    checkAuth();
                    return;
                }
                
                const clientsData = await clientsRes.json();
                const servicesData = await servicesRes.json();
                
                let clientOptions = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>';
                if (clientsData.success && clientsData.data) {
                    clientsData.data.forEach(c => {
                        clientOptions += `<option value="${c.id}">${c.name} (${c.phone})</option>`;
                    });
                }
                
                let serviceOptions = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>';
                if (servicesData.success && servicesData.data) {
                    servicesData.data.forEach(s => {
                        serviceOptions += `<option value="${s.id}">${s.name} - ${s.price}‚ÇΩ (${s.duration}–º–∏–Ω)</option>`;
                    });
                }
                
                document.getElementById('bookingClient').innerHTML = clientOptions;
                document.getElementById('bookingService').innerHTML = serviceOptions;
                
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('bookingDate').value = today;
                
                await loadAvailableTime();
                
                document.getElementById('bookingModal').style.display = 'block';
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function loadAvailableTime() {
            const date = document.getElementById('bookingDate').value;
            if (!date) return;
            
            try {
                const response = await fetch(`/api/plugins/beautymaster/availability?date=${date}`);
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                let timeOptions = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</option>';
                if (data.success && data.available_slots && data.available_slots.length > 0) {
                    data.available_slots.forEach(slot => {
                        timeOptions += `<option value="${slot}">${slot}</option>`;
                    });
                } else {
                    timeOptions = '<option value="">–ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</option>';
                }
                
                document.getElementById('bookingTime').innerHTML = timeOptions;
            } catch (error) {
                console.error('Error:', error);
            }
        }

        window.saveBooking = async function() {
            const data = {
                client_id: parseInt(document.getElementById('bookingClient').value),
                service_id: parseInt(document.getElementById('bookingService').value),
                date: document.getElementById('bookingDate').value,
                time: document.getElementById('bookingTime').value,
                notes: document.getElementById('bookingNotes').value
            };
            
            if (!data.client_id || !data.service_id || !data.date || !data.time) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            try {
                const response = await fetch('/api/plugins/beautymaster/bookings', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    hideModal('bookingModal');
                    loadBookings();
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + (result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        window.deleteBooking = async function(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?')) return;
            
            try {
                const response = await fetch(`/api/plugins/beautymaster/bookings/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadBookings();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
            }
        }

        document.getElementById('bookingDate')?.addEventListener('change', loadAvailableTime);

        // ==================== –ü–†–û–§–ò–õ–¨ ====================
        async function loadProfile() {
            try {
                const response = await fetch('/api/plugins/beautymaster/profile');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    const p = data.data;
                    document.getElementById('profile-form').innerHTML = `
                        <div class="bm-form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–ª–æ–Ω–∞</label>
                            <input type="text" id="salonName" value="${p.salon_name || ''}">
                        </div>
                        <div class="bm-form-group">
                            <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="text" id="salonPhone" value="${p.phone || ''}">
                        </div>
                        <div class="bm-form-group">
                            <label>–ê–¥—Ä–µ—Å</label>
                            <input type="text" id="salonAddress" value="${p.address || ''}">
                        </div>
                        <div class="bm-form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="salonDescription" rows="3">${p.description || ''}</textarea>
                        </div>
                        <button class="bm-btn bm-btn-primary" onclick="saveProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    `;
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        window.saveProfile = async function() {
            try {
                const response = await fetch('/api/plugins/beautymaster/profile', {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        salon_name: document.getElementById('salonName').value,
                        phone: document.getElementById('salonPhone').value,
                        address: document.getElementById('salonAddress').value,
                        description: document.getElementById('salonDescription').value
                    })
                });
                
                if (response.ok) {
                    alert('–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        // ==================== –†–ê–°–ü–ò–°–ê–ù–ò–ï ====================
        async function loadSchedule() {
            try {
                const response = await fetch('/api/plugins/beautymaster/schedule');
                if (response.status === 401) {
                    checkAuth();
                    return;
                }
                const data = await response.json();
                
                if (data.success) {
                    const days = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'];
                    let html = '';
                    
                    let schedule = data.data;
                    if (!schedule || schedule.length === 0) {
                        schedule = [];
                        for (let i = 0; i < 7; i++) {
                            schedule.push({
                                day_of_week: i,
                                is_working: i < 5,
                                start_time: i < 5 ? '09:00' : null,
                                end_time: i < 5 ? '18:00' : null
                            });
                        }
                    }
                    
                    schedule.forEach((s, index) => {
                        html += `
                            <div class="bm-form-group" style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px; padding: 10px; background: #4b4b4b; border-radius: 5px;">
                                <input type="checkbox" id="day_${index}" ${s.is_working ? 'checked' : ''} onchange="toggleDay(${index})" style="width: 20px; height: 20px;">
                                <label style="width: 120px; font-weight: bold;" for="day_${index}">${days[s.day_of_week]}</label>
                                <input type="time" id="start_${index}" value="${s.start_time || '09:00'}" ${!s.is_working ? 'disabled' : ''} style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100px;">
                                <span style="font-weight: bold;">‚Äî</span>
                                <input type="time" id="end_${index}" value="${s.end_time || '18:00'}" ${!s.is_working ? 'disabled' : ''} style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100px;">
                            </div>
                        `;
                    });
                    
                    html += '<button class="bm-btn bm-btn-primary" onclick="saveSchedule()" style="margin-top: 10px;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>';
                    document.getElementById('schedule-form').innerHTML = html;
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç—É—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–æ—Ç–∞
                loadBotStatus();
                loadBotStats();
                
            } catch (error) {
                console.error('Error loading schedule:', error);
                document.getElementById('schedule-form').innerHTML = '<p style="color: red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</p>';
            }
        }

        window.toggleDay = function(index) {
            const checkbox = document.getElementById(`day_${index}`);
            const start = document.getElementById(`start_${index}`);
            const end = document.getElementById(`end_${index}`);
            
            if (start && end) {
                start.disabled = !checkbox.checked;
                end.disabled = !checkbox.checked;
            }
        }

        window.saveSchedule = async function() {
            const schedule = [];
            
            for (let i = 0; i < 7; i++) {
                const checkbox = document.getElementById(`day_${i}`);
                if (!checkbox) continue;
                
                const day = {
                    day_of_week: i,
                    is_working: checkbox.checked
                };
                
                if (day.is_working) {
                    const startInput = document.getElementById(`start_${i}`);
                    const endInput = document.getElementById(`end_${i}`);
                    day.start_time = startInput ? startInput.value : '09:00';
                    day.end_time = endInput ? endInput.value : '18:00';
                }
                
                schedule.push(day);
            }
            
            try {
                const response = await fetch('/api/plugins/beautymaster/schedule', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(schedule)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
                    loadSchedule();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + (result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            } catch (error) {
                console.error('Error saving schedule:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        // ==================== –ë–û–¢ ====================
        window.toggleTokenVisibility = function() {
            const input = document.getElementById('botToken');
            tokenVisible = !tokenVisible;
            input.type = tokenVisible ? 'text' : 'password';
        }

        window.clearToken = function() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω? –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –±–æ—Ç –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.')) {
                document.getElementById('botToken').value = '';
                document.getElementById('botToken').type = 'text';
                tokenVisible = true;
            }
        }

        async function loadBotStatus() {
            try {
                const response = await fetch('/api/plugins/beautymaster/bot-status');
                const data = await response.json();
                
                if (data.success) {
                    const statusDiv = document.getElementById('bot-status');
                    const config = data.data;
                    
                    if (config.running) {
                        statusDiv.innerHTML = '<div style="background: #d4edda; color: #155724; padding: 10px; border-radius: 5px;">‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>';
                    } else if (config.enabled && config.configured) {
                        statusDiv.innerHTML = '<div style="background: #fff3cd; color: #856404; padding: 10px; border-radius: 5px;">‚ö†Ô∏è –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω. –ù–∞–∂–º–∏—Ç–µ "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å"</div>';
                    } else if (config.configured) {
                        statusDiv.innerHTML = '<div style="background: #fff3cd; color: #856404; padding: 10px; border-radius: 5px;">‚ö†Ô∏è –ë–æ—Ç –æ—Ç–∫–ª—é—á–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö</div>';
                    } else {
                        statusDiv.innerHTML = '<div style="background: #f8d7da; color: #721c24; padding: 10px; border-radius: 5px;">‚ùå –ë–æ—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ ID</div>';
                    }
                    
                    document.getElementById('botToken').value = config.configured ? '********' : '';
                    document.getElementById('adminId').value = config.admin_id || '';
                    document.getElementById('botEnabled').checked = config.enabled;
                }
            } catch (error) {
                console.error('Error loading bot status:', error);
            }
        }

        async function loadBotStats() {
            try {
                const response = await fetch('/api/plugins/beautymaster/bot-stats');
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    document.getElementById('bot-stats-content').innerHTML = `
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div><strong>üë• –ö–ª–∏–µ–Ω—Ç–æ–≤ –≤ Telegram:</strong> ${stats.total_telegram_clients}</div>
                            <div><strong>üìÖ –ó–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ –±–æ—Ç–∞:</strong> ${stats.telegram_bookings}</div>
                            <div><strong>üîî –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤:</strong> ${stats.active_subscribers}</div>
                            <div><strong>ü§ñ –°—Ç–∞—Ç—É—Å:</strong> ${stats.bot_running ? '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç' : '‚èπ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading bot stats:', error);
            }
        }

        window.saveBotSettings = async function() {
            const tokenInput = document.getElementById('botToken');
            const adminId = document.getElementById('adminId').value;
            const enabled = document.getElementById('botEnabled').checked;
            
            let token = tokenInput.value;
            
            const data = {};
            
            if (token && token !== '********') {
                data.telegram_bot_token = token;
                console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω');
            }
            
            data.telegram_admin_id = adminId;
            data.telegram_notifications = enabled;
            
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:', { 
                hasNewToken: !!data.telegram_bot_token,
                adminId, 
                enabled 
            });
            
            try {
                const response = await fetch('/api/plugins/beautymaster/profile', {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                    
                    if (data.telegram_bot_token) {
                        tokenInput.value = '********';
                        tokenInput.type = 'password';
                        tokenVisible = false;
                    }
                    
                    loadBotStatus();
                    loadBotStats();
                    
                    if (enabled && (data.telegram_bot_token || token === '********')) {
                        setTimeout(() => {
                            restartBot();
                        }, 1000);
                    }
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + (result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }
        }

        window.testBot = async function() {
            const tokenInput = document.getElementById('botToken');
            const adminId = document.getElementById('adminId').value;
            
            let token = tokenInput.value;
            
            if (token === '********') {
                token = 'USE_EXISTING';
            }
            
            if (!adminId) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                return;
            }
            
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞...');
            
            try {
                const response = await fetch('/api/plugins/beautymaster/test-bot', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({token, admin_id: adminId})
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram.');
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + result.error);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            }
        }

        window.restartBot = async function() {
            try {
                const response = await fetch('/api/plugins/beautymaster/bot-restart', {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω');
                    loadBotStatus();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + (result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞');
            }
        }

        // ==================== –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò ====================
        window.hideModal = function(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('bm-modal')) {
                event.target.style.display = 'none';
            }
        }

        // ==================== –ó–ê–ü–£–°–ö ====================
        checkAuth();
    </script>
</div>